Бизнес логика брендирования, стилизации и выбора рекомендованных очень убогая. Ее надо доводить до ума.
Убрать лишние поля возвращяемые в запросах sql